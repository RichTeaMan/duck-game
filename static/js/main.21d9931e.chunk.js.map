{"version":3,"sources":["game/utils.ts","game/direction.ts","game/entity.ts","game/entityType.ts","game/invisibleTarget.ts","game/duck.ts","game/food.ts","game/gameState.ts","game/nest.ts","game/gameScene.ts","game/uiScene.ts","game/gameRunner.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["randomInt","max","Math","floor","random","randomElement","array","length","Direction","name","offset","x","y","opposite","this","west","northWest","north","northEast","east","southEast","south","southWest","map","list","push","i","vector","angle","Phaser","Angle","Between","abs","quad","initialise","EntityType","Entity","gameState","imageName","image","isDestroyed","scene","add","on","pointer","onPointerDown","destroy","otherEntity","Distance","entity","speed","vectorToTarget","dx","dy","xR","cos","yR","sin","total","modX","modY","console","error","RadToDeg","Vector2","InvisibleTarget","depth","setVisible","debug","showTargets","Invisible","duckAnims","walk","startFrame","endFrame","feed","quack","stand","standFlap","DuckType","duckTypes","Duck","duckType","duckling","motion","anim","direction","f","target","animationStep","active","idleTicks","thought","leaderDuck","age","nesting","scale","setInteractive","cursor","input","hitArea","setTo","time","delayedCall","changeFrame","pointerHandled","event","stopImmediatePropagation","startQuackAnimation","thoughts","cache","json","get","uiScene","displayDuckInfo","delay","localF","startWalkAnimation","startStandFlapAnimation","frame","texture","isPointWater","nest","vectorToEntity","determineFromVector","quackTrack","CHIRPS","QUACKS","sound","play","volume","DUCKLING_MATURATION_AGE","displayToast","oppDir","justBehindX","justBehindY","entityType","fetchFood","select","distance","distanceFromEntity","sort","reverse","startStandAnimation","waterTile","waterTiles","addEntity","Food","startFeedAnimation","start","bread","entities","GameState","cursors","showMouseData","showResolutionData","showUiResolutionData","cameraPanning","activePointer","fetchPointer","cameras","main","getWorldPoint","forEach","update","newEntities","filter","e","r","getBounds","rectangle","width","height","contains","_instance","Nest","nestingDuck","nestingTime","ducks","fetchDucks","duck","sendToNest","log","trace","NESTING_DURATION","nestingComplete","ducklingCount","names","leader","GameScene","singleton","load","spritesheet","frameWidth","frameHeight","audio","keyboard","createCursorKeys","setDefaultCursor","leftButtonDown","point","createBread","buildMap","randomTile","randomDuckType","create","scrollX","scrollY","zoom","resize","loop","gameSize","baseSize","displaySize","resolution","x2","TARGET_WIDTH","pruneEntities","left","isDown","right","up","down","data","tileWidthHalf","tilewidth","tileHeightHalf","tileheight","layer","layers","mapWidth","mapHeight","centerX","id","tx","ty","tile","FONT_FAMILY","UiScene","key","duckInfoObjects","debugMessage","toastMessages","toastX","toastY","toastYMargin","previousHeight","previousWidth","addText","startBeginningMessage","children","getAll","child","ui","ratioX","ratioY","debugMsg","worldPointer","fetchWorldPointerPosition","toFixed","camera","text","helloMessage","findMiddleWidth","alpha","foodMessage","timeLine","tweens","timeline","targets","duration","size","textObject","fontFamily","fontSize","seconds","element","title","fontStyle","message","toast","t","repositionToasts","toastMessage","object","gameConfig","type","mode","RESIZE","parent","backgroundColor","App","className","href","rel","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.21d9931e.chunk.js","sourcesContent":["export function randomInt(max: number): number {\r\n    return Math.floor(Math.random() * Math.floor(max));\r\n}\r\n\r\nexport function randomElement<T>(array: Array<T>) : T {\r\n    const i = randomInt(array.length);\r\n    return array[i];\r\n}","import { randomInt } from \"./utils\";\r\n\r\nexport class Direction {\r\n\r\n    static west: Direction;\r\n    static northWest: Direction;\r\n    static north: Direction;\r\n    static northEast: Direction;\r\n    static east: Direction;\r\n    static southEast: Direction;\r\n    static south: Direction;\r\n    static southWest: Direction;\r\n\r\n    static map: Direction[];\r\n    static list: Direction[];\r\n\r\n    static initialise() {\r\n\r\n        Direction.west = new Direction('west', 0, -2, 0);\r\n        Direction.northWest = new Direction('northWest', 32, -2, -1);\r\n        Direction.north = new Direction('north', 64, 0, -2);\r\n        Direction.northEast = new Direction('northEast', 96, 2, -1);\r\n        Direction.east = new Direction('east', 128, 2, 0);\r\n        Direction.southEast = new Direction('southEast', 160, 2, 1);\r\n        Direction.south = new Direction('south', 192, 0, 2);\r\n        Direction.southWest = new Direction('southWest', 224, -2, 1);\r\n\r\n        Direction.west.opposite = Direction.east;\r\n        Direction.northWest.opposite = Direction.southEast;\r\n        Direction.north.opposite = Direction.south;\r\n        Direction.northEast.opposite = Direction.southWest;\r\n        Direction.east.opposite = Direction.west;\r\n        Direction.southEast.opposite = Direction.northWest;\r\n        Direction.south.opposite = Direction.north;\r\n        Direction.southWest.opposite = Direction.northEast;\r\n\r\n        Direction.map = [];\r\n        Direction.map[Direction.west.name] = Direction.west;\r\n        Direction.map[Direction.northWest.name] = Direction.northWest;\r\n        Direction.map[Direction.north.name] = Direction.north;\r\n        Direction.map[Direction.northEast.name] = Direction.northEast;\r\n        Direction.map[Direction.east.name] = Direction.east;\r\n        Direction.map[Direction.southEast.name] = Direction.southEast;\r\n        Direction.map[Direction.south.name] = Direction.south;\r\n        Direction.map[Direction.southWest.name] = Direction.southWest;\r\n\r\n        Direction.list = [];\r\n        Direction.list.push(Direction.west);\r\n        Direction.list.push(Direction.northWest);\r\n        Direction.list.push(Direction.north);\r\n        Direction.list.push(Direction.northEast);\r\n        Direction.list.push(Direction.east);\r\n        Direction.list.push(Direction.southEast);\r\n        Direction.list.push(Direction.south);\r\n        Direction.list.push(Direction.southWest);\r\n    }\r\n\r\n    static get(name: string): Direction {\r\n        return Direction.map[name];\r\n    }\r\n\r\n    static random(): Direction {\r\n        const i = randomInt(Direction.list.length);\r\n        return Direction.list[i];\r\n    }\r\n\r\n    static determineFromVector(vector: Phaser.Math.Vector2) {\r\n\r\n        const angle = Phaser.Math.Angle.Between(0, 0, Math.abs(vector.x), Math.abs(vector.y));\r\n\r\n        let quad = [];\r\n\r\n        // calculate quads for annoying trig and negative sign reasons. In phaser, 0,0 is top left so Y is inverted.\r\n\r\n        // top left quad\r\n        if (vector.x >= 0 && vector.y < 0) {\r\n            quad = [Direction.east, Direction.northEast, Direction.north];\r\n        }\r\n        // bottom left\r\n        else if (vector.x >= 0 && vector.y >= 0) {\r\n            quad = [Direction.east, Direction.southEast, Direction.south];\r\n        }\r\n        // top right\r\n        else if (vector.x < 0 && vector.y < 0) {\r\n            quad = [Direction.west, Direction.northWest, Direction.north];\r\n        }\r\n        // bottom right\r\n        else if (vector.x < 0 && vector.y >= 0) {\r\n            quad = [Direction.west, Direction.southWest, Direction.south];\r\n        }\r\n\r\n        let i = 0;\r\n        if (angle > 1.178097) { // 67.5 deg\r\n            i = 2;\r\n        }\r\n        else if (angle > 0.3926991) { // 22.5 deg\r\n            i = 1;\r\n        }\r\n\r\n        const direction = quad[i];\r\n        return direction;\r\n    }\r\n\r\n    name: string;\r\n    offset: number;\r\n    x: number;\r\n    y: number;\r\n    opposite: Direction;\r\n\r\n    constructor(name: string, offset: number, x: number, y: number) {\r\n        this.name = name;\r\n        this.offset = offset;\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\nDirection.initialise();\r\n","import { EntityType } from \"./entityType\";\r\nimport { GameState } from \"./gameState\";\r\n\r\nexport abstract class Entity {\r\n\r\n    image: Phaser.GameObjects.Image;\r\n    isDestroyed = false;\r\n    gameState: GameState;\r\n\r\n    constructor(gameState: GameState, imageName: string, x: number, y: number) {\r\n        this.image = gameState.scene.add.image(x, y, imageName);\r\n        this.gameState = gameState;\r\n\r\n        this.image.on('pointerdown', (pointer: Phaser.Input.Pointer) => {\r\n            this.onPointerDown(pointer)\r\n        });\r\n    }\r\n\r\n    abstract entityType(): EntityType;\r\n\r\n    onPointerDown(pointer: Phaser.Input.Pointer) {\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n    }\r\n\r\n    destroy() {\r\n        this.isDestroyed = true;\r\n        if (this.image)\r\n            this.image.destroy();\r\n    }\r\n\r\n    distanceFromEntity(otherEntity: Entity) {\r\n        return Phaser.Math.Distance.Between(this.x, this.y, otherEntity.x, otherEntity.y);\r\n    }\r\n\r\n    vectorToEntity(entity: Entity, speed: number) {\r\n        return this.vectorToTarget(entity.x, entity.y, speed);\r\n    }\r\n\r\n    vectorToTarget(x: number, y: number, speed: number) {\r\n\r\n        const dx = x - this.x;\r\n        const dy = y - this.y;\r\n\r\n        const angle = Phaser.Math.Angle.Between(this.x, this.y, x, y);\r\n        let xR = Math.cos(angle);\r\n        let yR = Math.sin(angle);\r\n\r\n        const total =  Math.abs(xR) + Math.abs(yR);\r\n        let modX = (xR / total) * speed;\r\n        let modY = (yR / total) * speed;\r\n\r\n        if (modX > 10 || modY > 10) {\r\n\r\n            console.error(`Spurious vectorToTargetResult - C: ${x}, ${y} | A: ${Phaser.Math.RadToDeg(angle)} | ${dx}, ${dy} | ${modX}, ${modY}`);\r\n\r\n            if (modX > speed) {\r\n                modX = speed;\r\n            }\r\n            else if (modX < -speed) {\r\n                modX = -speed;\r\n            }\r\n\r\n            if (modY > speed) {\r\n                modY = speed;\r\n            }\r\n            else if (modY < -speed) {\r\n                modY = -speed;\r\n            }\r\n        }\r\n        return new Phaser.Math.Vector2(modX, modY);\r\n    }\r\n\r\n    get x() {\r\n        return this.image.x;\r\n    }\r\n    set x(x: number) {\r\n        this.image.x = x;\r\n    }\r\n\r\n    get y() {\r\n        return this.image.y;\r\n    }\r\n    set y(y: number) {\r\n        this.image.y = y;\r\n    }\r\n}\r\n","export enum EntityType {\r\n    Food,\r\n    Duck,\r\n    Invisible,\r\n    Nest\r\n}","import { Entity } from \"./entity\";\r\nimport { EntityType } from \"./entityType\";\r\nimport { GameState } from \"./gameState\";\r\n\r\nexport class InvisibleTarget extends Entity {\r\n\r\n    constructor(gameState: GameState, x: number, y: number) {\r\n        super(gameState, 'target', x, y);\r\n\r\n        this.image.depth = 10000;\r\n        this.image.setVisible(gameState.debug.showTargets);\r\n    }\r\n\r\n    entityType(): EntityType {\r\n        return EntityType.Invisible;\r\n    }\r\n\r\n    update() {\r\n    }\r\n}\r\n","import { Direction } from \"./direction\";\r\nimport { Entity } from \"./entity\";\r\nimport { EntityType } from \"./entityType\";\r\nimport { GameState } from \"./gameState\";\r\nimport { InvisibleTarget } from \"./invisibleTarget\";\r\nimport { Nest } from \"./nest\";\r\nimport { randomElement, randomInt } from \"./utils\";\r\n\r\nconst duckAnims = {\r\n    walk: {\r\n        startFrame: 0,\r\n        endFrame: 4,\r\n        speed: 0.20\r\n    },\r\n    feed: {\r\n        startFrame: 5,\r\n        endFrame: 7,\r\n        speed: 0.8\r\n    },\r\n    quack: {\r\n        startFrame: 8,\r\n        endFrame: 10,\r\n        speed: 0.6\r\n    },\r\n    stand: {\r\n        startFrame: 11,\r\n        endFrame: 13,\r\n        speed: 0.2\r\n    },\r\n    standFlap: {\r\n        startFrame: 14,\r\n        endFrame: 16,\r\n        speed: 0.2\r\n    }\r\n};\r\n\r\nexport class DuckType {\r\n    static duckTypes = [\r\n        \"white\",\r\n        \"mallard\",\r\n        \"brown\",\r\n        \"mandarin\"\r\n    ];\r\n\r\n    static random() {\r\n        return DuckType.duckTypes[randomInt(DuckType.duckTypes.length)];\r\n    }\r\n}\r\n\r\nexport class Duck extends Entity {\r\n\r\n    static QUACKS = [\r\n        \"quack-f1\",\r\n        \"quackquack-f1\",\r\n        \"quack-f2\",\r\n        \"quackquack-f2\",\r\n        \"quack-m1\",\r\n        \"quackquack-m1\"\r\n    ];\r\n\r\n    static CHIRPS = [\r\n        \"chirp1\",\r\n        \"chirpchirp1\",\r\n        \"chirp2\",\r\n        \"chirpchirp2\"\r\n    ];\r\n\r\n    /**\r\n     * Gets the age in ticks when a duckling should age into a duck.\r\n     */\r\n    static DUCKLING_MATURATION_AGE = 30000;\r\n\r\n    name = randomElement([\"Daisy\", \"Mavis\", \"Harold\", \"Ernest\", \"Ermintrude\", \"Annie\", \"Reginald\", \"Clarence\", \"Emmett\", \"Gert\", \"Hilda\", \"Doris\", \"Hattie\"]);\r\n\r\n    motion: any;\r\n    anim: any;\r\n    direction: Direction = Direction.random();\r\n    speed: number;\r\n\r\n    /**\r\n     * Frame.\r\n     */\r\n    f: number;\r\n\r\n    target: Entity = null;\r\n    vector: Phaser.Math.Vector2 = null;\r\n\r\n    animationStep = 1;\r\n\r\n    active = true;\r\n\r\n    idleTicks = 0;\r\n\r\n    thought: string = '';\r\n\r\n    /**\r\n     * The duck this duck should follow.\r\n     */\r\n    leaderDuck: Duck;\r\n\r\n    duckType: DuckType;\r\n\r\n    duckling: boolean;\r\n\r\n    /**\r\n     * Age of the duck in ticks.\r\n     */\r\n    age = 0;\r\n\r\n    private nesting = false;\r\n\r\n    constructor(gameState: GameState, x: number, y: number, duckType: string, duckling = false) {\r\n        super(gameState, duckling ? `duck-duckling` : `duck-${duckType}`, x, y);\r\n        if (duckling) {\r\n            this.image.scale = 0.4;\r\n        }\r\n        else {\r\n            this.image.scale = 0.8;\r\n        }\r\n\r\n        this.duckling = duckling;\r\n\r\n        this.image.setInteractive({ cursor: 'pointer' });\r\n        this.image.input.hitArea.setTo(128, 128, 512 - 128, 512 - 128);\r\n\r\n        this.duckType = duckType;\r\n        this.motion = 'walk';\r\n        this.anim = duckAnims[this.motion];\r\n        this.speed = this.anim.speed;\r\n        this.f = this.anim.startFrame;\r\n\r\n        this.gameState.scene.time.delayedCall(this.anim.speed * 1000, this.changeFrame, [], this);\r\n    };\r\n\r\n    onPointerDown(pointer: Phaser.Input.Pointer) {\r\n        this.gameState.pointerHandled = true;\r\n        pointer.event.stopImmediatePropagation();\r\n        this.startQuackAnimation();\r\n        this.quack();\r\n        const thoughts = this.gameState.scene.cache.json.get('duck-thoughts') as Array<string>;\r\n        this.thought = randomElement(thoughts);\r\n        this.gameState.uiScene.displayDuckInfo(this);\r\n    }\r\n\r\n    entityType(): EntityType {\r\n        return EntityType.Duck;\r\n    }\r\n\r\n    startWalkAnimation() {\r\n        this.f = duckAnims['walk'].startFrame;\r\n        this.anim = duckAnims['walk'];\r\n        this.animationStep = 1;\r\n        this.motion = 'walk';\r\n        this.changeFrame();\r\n        this.active = true;\r\n    }\r\n\r\n    startFeedAnimation() {\r\n        this.f = duckAnims['feed'].startFrame;\r\n        this.anim = duckAnims['feed'];\r\n        this.animationStep = 1;\r\n        this.motion = 'feed';\r\n        this.changeFrame();\r\n        this.active = false;\r\n    }\r\n\r\n    startQuackAnimation() {\r\n        this.f = duckAnims['quack'].startFrame;\r\n        this.anim = duckAnims['quack'];\r\n        this.animationStep = 1;\r\n        this.motion = 'quack';\r\n        this.changeFrame();\r\n        this.active = false;\r\n    }\r\n\r\n    startStandAnimation() {\r\n        this.f = duckAnims['stand'].startFrame;\r\n        this.anim = duckAnims['stand'];\r\n        this.animationStep = 1;\r\n        this.motion = 'stand';\r\n        this.changeFrame();\r\n        this.active = true;\r\n    }\r\n\r\n    startStandFlapAnimation() {\r\n        this.f = duckAnims['standFlap'].startFrame;\r\n        this.anim = duckAnims['standFlap'];\r\n        this.animationStep = 1;\r\n        this.motion = 'standFlap';\r\n        this.changeFrame();\r\n        this.active = true;\r\n    }\r\n\r\n    changeFrame() {\r\n\r\n        let delay = this.anim.speed;\r\n        this.image.depth = this.y + 256;\r\n        let localF = this.f;\r\n\r\n        if (this.f > this.anim.endFrame || this.f < 0 || this.f < this.anim.startFrame) {\r\n            switch (this.motion) {\r\n                case 'walk':\r\n                    this.animationStep = -this.animationStep;\r\n                    this.f += 2 * this.animationStep;\r\n                    localF = this.f;\r\n                    break;\r\n\r\n                case 'feed':\r\n                    this.gameState.scene.time.delayedCall(delay * 1000, this.startWalkAnimation, [], this);\r\n                    return;\r\n\r\n                case 'quack':\r\n                    localF = this.f - 4;\r\n                    if (this.f === 11) {\r\n                        localF = 9;\r\n                    }\r\n                    else if (this.f > 16) {\r\n                        this.startWalkAnimation();\r\n                        return;\r\n                    }\r\n                    this.gameState.scene.time.delayedCall(delay * 1000, this.startWalkAnimation, [], this);\r\n                    break;\r\n\r\n                case 'stand':\r\n                    this.startStandFlapAnimation();\r\n                    return;\r\n                case 'standFlap':\r\n                    this.f = this.anim.startFrame;\r\n                    localF = this.f;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        this.image.frame = this.image.texture.get(this.direction.offset + localF);\r\n        this.gameState.scene.time.delayedCall(delay * 1000, this.changeFrame, [], this);\r\n        this.f += this.animationStep;\r\n    }\r\n\r\n    /**\r\n     * Moves the duck by the given amount, or returns false is fuck a movement isn't possible.\r\n     * @param modX Amount to move duck by.\r\n     * @param modY Amount to move duck by.\r\n     */\r\n    move(modX: number, modY: number): boolean {\r\n\r\n        if (this.gameState.isPointWater(this.x + modX, this.y + modY)) {\r\n            this.x += modX;\r\n            this.y += modY;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    sendToNest(nest: Nest) {\r\n\r\n        this.nesting = true;\r\n        this.target?.destroy();\r\n        this.target = nest;\r\n        this.vector = this.vectorToEntity(nest, 3);\r\n        this.direction = Direction.determineFromVector(this.vector);\r\n    }\r\n\r\n    nestingComplete() {\r\n        this.nesting = false;\r\n        this.target = null;\r\n        this.active = true;\r\n    }\r\n\r\n    quack() {\r\n        let quackTrack: string;\r\n        if (this.duckling) {\r\n            quackTrack = randomElement(Duck.CHIRPS);\r\n        }\r\n        else {\r\n            quackTrack = randomElement(Duck.QUACKS);\r\n        }\r\n        this.gameState.scene.sound.add(quackTrack).play({ volume: 0.2 });\r\n    }\r\n\r\n    update() {\r\n        this.age++;\r\n        if (this.duckling && this.age > Duck.DUCKLING_MATURATION_AGE) {\r\n\r\n            this.duckling = false;\r\n            this.leaderDuck = null;\r\n            this.target = null;\r\n            this.image.destroy();\r\n\r\n            this.image = this.gameState.scene.add.image(this.x, this.y, `duck-${this.duckType}`);\r\n            this.image.scale = 0.8;\r\n\r\n            this.gameState.uiScene.displayToast(`${this.name} is all grown up.`);\r\n        }\r\n\r\n        if (!this.active)\r\n            return;\r\n\r\n        // 0.05% chance to quack\r\n        if (randomInt(2000) === 1) {\r\n            this.quack();\r\n            this.startQuackAnimation();\r\n        }\r\n\r\n        if (this.leaderDuck != null) {\r\n            const oppDir = this.leaderDuck.direction.opposite;\r\n\r\n            const leaderOffset = 90;\r\n            const justBehindX = this.leaderDuck.x + leaderOffset * oppDir.x;\r\n            const justBehindY = this.leaderDuck.y + leaderOffset * oppDir.y;\r\n\r\n            this.vector = this.vectorToTarget(justBehindX, justBehindY, 1)\r\n            this.direction = Direction.determineFromVector(this.vector);\r\n        }\r\n\r\n        // find a target\r\n        if (this.target == null || this.target.isDestroyed || this.target.entityType() === EntityType.Invisible) {\r\n\r\n            // look for food\r\n            if (this.gameState.fetchFood().length > 0) {\r\n                const breadList = this.gameState.fetchFood().map(f => ({ distance: this.distanceFromEntity(f) + randomInt(30), target: f }));\r\n                const select = breadList.sort(f => f.distance).reverse()[0];\r\n                if (select.distance < 450) {\r\n\r\n                    this.target?.destroy();\r\n                    this.target = select.target;\r\n                    this.vector = this.vectorToEntity(this.target, 5);\r\n                    this.startStandAnimation();\r\n                }\r\n            }\r\n\r\n            // find a random point to swim too\r\n            if (this.target == null) {\r\n                // no bread, swim to random target\r\n                const waterTile = randomElement(this.gameState.waterTiles);\r\n                this.target = this.gameState.addEntity(new InvisibleTarget(this.gameState, waterTile.x, waterTile.y));\r\n\r\n                this.vector = this.vectorToEntity(this.target, 1);\r\n                this.startWalkAnimation();\r\n            }\r\n            this.direction = Direction.determineFromVector(this.vector);\r\n        }\r\n\r\n        if (!this.nesting && this.target != null && this.distanceFromEntity(this.target) < 2.5) {\r\n            this.target.destroy();\r\n\r\n            if (this.target.entityType() === EntityType.Food) {\r\n                this.startFeedAnimation();\r\n            }\r\n            this.target = null;\r\n            return;\r\n        }\r\n        if (this.nesting && this.distanceFromEntity(this.target) < 2.5) {\r\n            this.vector.x = 0;\r\n            this.vector.y = 0;\r\n            this.direction = Direction.west;\r\n            this.active = false;\r\n        }\r\n\r\n        this.x += this.vector.x;\r\n        this.y += this.vector.y;\r\n        this.image.depth = this.y + this.image.y;\r\n    }\r\n}\r\n","import { Entity } from \"./entity\";\r\nimport { EntityType } from \"./entityType\";\r\nimport { GameState } from \"./gameState\";\r\n\r\nexport class Food extends Entity {\r\n\r\n    static createBread(gameState: GameState, x: number, y: number): Food {\r\n\r\n        const bread = new Food(gameState, 'bread', x, y);\r\n        bread.image.scale = 0.6;\r\n        gameState.entities.push(bread);\r\n        return bread;\r\n    }\r\n\r\n    start = 0;\r\n\r\n    constructor(gameState: GameState, imageName: string, x: number, y: number) {\r\n        super(gameState, imageName, x, y);\r\n\r\n        this.image.depth = y + 32;\r\n    }\r\n\r\n    entityType(): EntityType {\r\n        return EntityType.Food;\r\n    }\r\n\r\n    update() {\r\n        this.start++;\r\n\r\n        if (this.start > 200) {\r\n            this.destroy();\r\n        }\r\n    }\r\n}\r\n","import { Duck } from \"./duck\";\r\nimport { Entity } from \"./entity\";\r\nimport { EntityType } from \"./entityType\";\r\nimport { Food } from \"./food\";\r\nimport { GameScene } from \"./gameScene\";\r\nimport { UiScene } from \"./uiScene\";\r\n\r\nexport class GameState {\r\n\r\n    private static _instance = null;\r\n    static singleton(): GameState {\r\n        if (GameState._instance == null) {\r\n            this._instance = new GameState();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    scene: GameScene;\r\n    uiScene: UiScene;\r\n    cursors: Phaser.Types.Input.Keyboard.CursorKeys;\r\n    entities: Array<Entity> = [];\r\n    waterTiles: Array<Phaser.GameObjects.Image> = [];\r\n\r\n    debug = {\r\n        showTargets: false,\r\n        showMouseData: true,\r\n        showResolutionData: true,\r\n        showUiResolutionData: true,\r\n        cameraPanning: true,\r\n    }\r\n\r\n    pointerHandled = false;\r\n\r\n    fetchPointer() {\r\n        return this.scene.input.activePointer;\r\n    }\r\n\r\n    fetchWorldPointerPosition() {\r\n        const pointer = this.fetchPointer();\r\n        const point = this.scene.cameras.main.getWorldPoint(pointer.x, pointer.y);\r\n        return point;\r\n    }\r\n\r\n    update() {\r\n        this.entities.forEach(entity => {\r\n            entity.update();\r\n        });\r\n\r\n        this.pointerHandled = false;\r\n    }\r\n\r\n    pruneEntities() {\r\n\r\n        const newEntities: Array<Entity> = [];\r\n        this.entities.forEach(entity => {\r\n            if (!entity.isDestroyed) {\r\n                newEntities.push(entity);\r\n            }\r\n        });\r\n        this.entities = newEntities;\r\n    }\r\n\r\n    fetchFood(): Food[] {\r\n        return this.entities.filter(e => e.entityType() === EntityType.Food && !e.isDestroyed) as Food[];\r\n    }\r\n\r\n    fetchDucks(): Duck[] {\r\n        return this.entities.filter(e => e.entityType() === EntityType.Duck && !e.isDestroyed) as Duck[];\r\n    }\r\n\r\n    addEntity(entity: Entity) {\r\n\r\n        this.entities.push(entity);\r\n        return entity;\r\n    }\r\n\r\n    showWaterCollision() {\r\n        for (let i = 0; i < this.waterTiles.length; i++) {\r\n            const tile = this.waterTiles[i];\r\n            const r = tile.getBounds();\r\n            this.scene.add.rectangle(r.x, r.y, r.width, r.height, 0x9966ff);\r\n        }\r\n    }\r\n\r\n    isPointWater(x: number, y: number) {\r\n        // collisions and drawing aren't aligned. no idea why.\r\n        for (let i = 0; i < this.waterTiles.length; i++) {\r\n            const tile = this.waterTiles[i];\r\n            if (tile.getBounds().contains(x + 60, y + 60)) {\r\n                this.scene.add.rectangle(x, y, 2, 2, 0xff0000);\r\n                return true;\r\n            }\r\n        }\r\n        this.scene.add.rectangle(x, y, 6, 6, 0x00ff00);\r\n        return false;\r\n    }\r\n}\r\n","import { Duck, DuckType } from \"./duck\";\r\nimport { Entity } from \"./entity\";\r\nimport { EntityType } from \"./entityType\";\r\nimport { GameState } from \"./gameState\";\r\nimport { randomElement, randomInt } from \"./utils\";\r\n\r\nexport class Nest extends Entity {\r\n\r\n    /**\r\n     * Gets duration a duck most nest for in ticks.\r\n     */\r\n    static NESTING_DURATION = 1000;\r\n\r\n    static create(gameState: GameState, x: number, y: number): Nest {\r\n\r\n        const nest = new Nest(gameState, 'nest', x, y);\r\n        gameState.addEntity(nest);\r\n        return nest;\r\n    }\r\n\r\n    private nestingDuck: Duck;\r\n\r\n    /**\r\n     * Gets how many ticks the current duck has nested for.\r\n     */\r\n    private nestingTime = 0;\r\n\r\n    constructor(gameState: GameState, imageName: string, x: number, y: number) {\r\n        super(gameState, imageName, x, y);\r\n\r\n        this.image.setInteractive({ cursor: 'pointer'});\r\n        this.image.depth = y + 200;\r\n        this.image.scale = 0.4;\r\n    }\r\n\r\n    onPointerDown(pointer: Phaser.Input.Pointer) {\r\n        this.gameState.pointerHandled = true;\r\n\r\n        if (this.nestingDuck != null) {\r\n            this.gameState.uiScene.displayToast(\"A duck is already nesting there.\");\r\n            return;\r\n        }\r\n\r\n        // choose a random non duckling\r\n        const ducks = this.gameState.fetchDucks().filter(f => f.duckType !== 'duckling');\r\n        if (ducks.length > 0) {\r\n            const duck = randomElement(ducks);\r\n            this.nestingDuck = duck;\r\n            this.gameState.uiScene.displayToast(`${duck.name} is feeling broody`);\r\n            this.nestingTime = 0;\r\n            duck.sendToNest(this);\r\n        }\r\n    }\r\n\r\n    entityType(): EntityType {\r\n        return EntityType.Nest;\r\n    }\r\n\r\n    destroy() {\r\n        console.log (\"nest destroyed!!!\");\r\n        console.trace();\r\n        super.destroy();\r\n    }\r\n\r\n    update() {\r\n\r\n        if (this.nestingDuck == null) {\r\n            return;\r\n        }\r\n\r\n        \r\n        if (this.distanceFromEntity(this.nestingDuck) < 2.5) {\r\n            this.nestingTime++;\r\n        }\r\n\r\n        if (this.nestingTime === 20) {\r\n            this.gameState.uiScene.displayToast(`${this.nestingDuck.name} has just started nesting`);\r\n        }\r\n        if (this.nestingTime === Math.floor(Nest.NESTING_DURATION * .5)) {\r\n            this.gameState.uiScene.displayToast(`${this.nestingDuck.name} has a while left to nest`);\r\n        }\r\n        if (this.nestingTime === Math.floor(Nest.NESTING_DURATION * 0.9)) {\r\n            this.gameState.uiScene.displayToast(`${this.nestingDuck.name} is feeling some rustling`);\r\n        }\r\n        if (this.nestingTime > Nest.NESTING_DURATION) {\r\n            this.nestingDuck.nestingComplete();\r\n\r\n            // generate some ducks\r\n            const ducklingCount = randomInt(5) + 1;\r\n            const names = [];\r\n            let leader = this.nestingDuck;\r\n            for (let i = 0; i < ducklingCount; i++) {\r\n                const duckling = new Duck(this.gameState, this.nestingDuck.x, this.nestingDuck.y, DuckType.random(), true);\r\n                duckling.leaderDuck = leader;\r\n                this.gameState.addEntity(duckling);\r\n                leader = duckling;\r\n                duckling.quack();\r\n                names.push(duckling.name);\r\n            }\r\n            this.gameState.uiScene.displayToast(`${this.nestingDuck.name} brood has hatched ${names.length} ducklings!`);\r\n            names.forEach(name => {\r\n                this.gameState.uiScene.displayToast(`Welcome ${name}`);\r\n            });\r\n\r\n            this.nestingDuck = null;\r\n        }\r\n    }\r\n}\r\n","import * as Phaser from 'phaser';\r\nimport { Duck, DuckType } from './duck';\r\nimport { Food } from './food';\r\nimport { TARGET_WIDTH } from './gameRunner';\r\nimport { GameState } from './gameState';\r\nimport { Nest } from './nest';\r\nimport { randomInt } from './utils';\r\n\r\n\r\nconst ZOOM_LEVEL = 0.4;\r\n\r\nexport class GameScene extends Phaser.Scene {\r\n\r\n    gameState: GameState;\r\n\r\n    constructor() {\r\n        super('GameScene');\r\n    }\r\n\r\n    preload() {\r\n        this.gameState = GameState.singleton();\r\n        this.gameState.scene = this;\r\n\r\n        const scene = this as Phaser.Scene;\r\n\r\n        scene.load.json('pond-map', 'assets/pond.json');\r\n        scene.load.spritesheet('landscape-tileset', 'assets/landscape-spritesheet.png', { frameWidth: 132, frameHeight: 100 });\r\n        scene.load.spritesheet('water', 'assets/landscapeTiles_066.png', { frameWidth: 132, frameHeight: 100 });\r\n        scene.load.image('nest', 'assets/nest.png');\r\n        \r\n        scene.load.spritesheet('duck-white', 'assets/duck-white-spritesheet.png', { frameWidth: 512, frameHeight: 512 });\r\n        scene.load.spritesheet('duck-mallard', 'assets/duck-mallard-spritesheet.png', { frameWidth: 512, frameHeight: 512 });\r\n        scene.load.spritesheet('duck-brown', 'assets/duck-brown-spritesheet.png', { frameWidth: 512, frameHeight: 512 });\r\n        scene.load.spritesheet('duck-mandarin', 'assets/duck-mandarin-spritesheet.png', { frameWidth: 512, frameHeight: 512 });\r\n        scene.load.spritesheet('duck-duckling', 'assets/duck-duckling-spritesheet.png', { frameWidth: 512, frameHeight: 512 });\r\n\r\n        scene.load.image('bread', 'assets/bread_NW.png');\r\n        scene.load.image('breadc', 'assets/bread_cursor.png');\r\n\r\n        scene.load.image('debug', 'assets/debug.png');\r\n        scene.load.image('target', 'assets/target.png');\r\n\r\n        scene.load.audio('quack-f1', 'assets/quack-f1.mp3');\r\n        scene.load.audio('quackquack-f1', 'assets/quackquack-f1.mp3');\r\n        scene.load.audio('quack-f2', 'assets/quack-f2.mp3');\r\n        scene.load.audio('quackquack-f2', 'assets/quackquack-f2.mp3');\r\n        scene.load.audio('quack-m1', 'assets/quack-m1.mp3');\r\n        scene.load.audio('quackquack-m1', 'assets/quackquack-m1.mp3');\r\n        scene.load.audio('chirp1', 'assets/chirp1.mp3');\r\n        scene.load.audio('chirpchirp1', 'assets/chirpchirp1.mp3');\r\n        scene.load.audio('chirp2', 'assets/chirp2.mp3');\r\n        scene.load.audio('chirpchirp2', 'assets/chirpchirp2.mp3');\r\n\r\n        scene.load.audio('ambience', 'assets/ambience.mp3');\r\n\r\n        scene.load.json('duck-thoughts', 'assets/duck-thoughts.json');\r\n    }\r\n\r\n    create() {\r\n        this.gameState.cursors = this.input.keyboard.createCursorKeys();\r\n\r\n        this.input.setDefaultCursor('url(assets/bread_cursor.png), crosshair');\r\n        this.input.on('pointerdown', function (pointer: Phaser.Input.Pointer) {\r\n            if (this.gameState.pointerHandled)\r\n                return;\r\n\r\n            if (pointer.leftButtonDown()) {\r\n                const point = this.gameState.scene.cameras.main.getWorldPoint(pointer.x, pointer.y);\r\n                Food.createBread(this.gameState, point.x, point.y + 40);\r\n            }\r\n        }, this);\r\n\r\n        this.buildMap();\r\n\r\n        const x_offset = 4550;\r\n        const y_offset = 2000;\r\n\r\n        const startDucks = 7;\r\n        for (let i = 0; i < startDucks; i++) {\r\n            const randomTile = this.gameState.waterTiles[randomInt(this.gameState.waterTiles.length)];\r\n            const randomDuckType = DuckType.random();\r\n\r\n            this.gameState.addEntity(new Duck(this.gameState, randomTile.x, randomTile.y, randomDuckType));\r\n        }\r\n\r\n        Nest.create(this.gameState, 7013, 2144);\r\n\r\n        this.gameState.scene.cameras.main.scrollX = x_offset;\r\n        this.gameState.scene.cameras.main.scrollY = y_offset;\r\n        this.gameState.scene.cameras.main.zoom = ZOOM_LEVEL;\r\n\r\n        this.scale.on('resize', this.resize, this);\r\n        this.resize({width: this.gameState.scene.cameras.main.width, height: this.gameState.scene.cameras.main.width}, null, null, null);\r\n\r\n        this.gameState.scene.sound.add('ambience').play({ volume: 0.2, loop: true });\r\n    }\r\n\r\n\r\n    resize(gameSize, baseSize, displaySize, resolution) {\r\n        // resets camera zoom and adjusts offset.\r\n\r\n        var width = gameSize.width;\r\n        var height = gameSize.height;\r\n\r\n        const target = TARGET_WIDTH / ZOOM_LEVEL;\r\n        const x2 = target / gameSize.width;\r\n        this.gameState.scene.cameras.main.zoom = 1 / x2;\r\n\r\n        this.gameState.scene.cameras.main.scrollX = width * -0.89 + 5898;\r\n        this.gameState.scene.cameras.main.scrollY = height * -0.52 + 2600;\r\n\r\n        this.gameState.uiScene.resize();\r\n    }\r\n\r\n    update() {\r\n        this.gameState.update();\r\n        this.gameState.pruneEntities();\r\n\r\n        if (this.gameState.debug.cameraPanning) {\r\n            const cursor = this.input.keyboard.createCursorKeys();\r\n            if (cursor.left.isDown) {\r\n                this.gameState.scene.cameras.main.scrollX -= 10;\r\n            }\r\n            if (cursor.right.isDown) {\r\n                this.gameState.scene.cameras.main.scrollX += 10;\r\n            }\r\n            if (cursor.up.isDown) {\r\n                this.gameState.scene.cameras.main.scrollY -= 10;\r\n            }\r\n            if (cursor.down.isDown) {\r\n                this.gameState.scene.cameras.main.scrollY += 10;\r\n            }\r\n        }\r\n    }\r\n\r\n    buildMap() {\r\n        //  Parse the data out of the map\r\n        const data = this.gameState.scene.cache.json.get('pond-map');\r\n\r\n        const tileWidth = data.tilewidth;\r\n        const tileHeight = data.tileheight;\r\n\r\n        const tileWidthHalf = tileWidth / 2;\r\n        const tileHeightHalf = tileHeight / 2;\r\n\r\n        const layer = data.layers[0].data;\r\n\r\n        const mapWidth = data.layers[0].width;\r\n        const mapHeight = data.layers[0].height;\r\n\r\n        const centerX = mapWidth * tileWidthHalf;\r\n        const centerY = 32;\r\n\r\n        let i = 0;\r\n\r\n        for (let y = 0; y < mapHeight; y++) {\r\n            for (let x = 0; x < mapWidth; x++) {\r\n                const id = layer[i] - 1;\r\n\r\n                const tx = (x - y) * tileWidthHalf;\r\n                const ty = (x + y) * tileHeightHalf;\r\n\r\n                let tile: Phaser.GameObjects.Image;\r\n\r\n                // 53 is water\r\n                if (id === 53) {\r\n                    //tile = gameState.scene.add.image(centerX + tx, centerY + ty, 'debug');\r\n\r\n                    // DIRTY HACK - the spritesheet has bleeding in some cases (specifically, I think the sheet is fine, but reading it somehow causes alignment problems).\r\n                    // Usually it's fine but water gets particular ugly at different zoom levels, so swap in a pure tile.\r\n                    tile = this.gameState.scene.add.image(centerX + tx, centerY + ty, 'water');\r\n                    //tile.setVisible(false);\r\n                    this.gameState.waterTiles.push(tile);\r\n                } else {\r\n                    tile = this.gameState.scene.add.image(centerX + tx, centerY + ty, 'landscape-tileset', id);\r\n                }\r\n\r\n                tile.depth = centerY + ty;\r\n                i++;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import * as Phaser from 'phaser';\r\nimport { Duck } from './duck';\r\nimport { GameState } from './gameState';\r\n\r\nconst FONT_FAMILY = 'Perpetua , Georgia, \"Goudy Bookletter 1911\", Times, serif';\r\n\r\nexport class UiScene extends Phaser.Scene {\r\n\r\n\r\n    gameState: GameState;\r\n\r\n    duckInfoObjects: Array<{ destroy(): void }> = [];\r\n\r\n    debugMessage: Phaser.GameObjects.Text;\r\n\r\n    toastMessages: Array<Phaser.GameObjects.Text> = [];\r\n    toastX = 50;\r\n    toastY = 400;\r\n    toastYMargin = 15;\r\n\r\n    previousHeight = 0;\r\n    previousWidth = 0;\r\n\r\n\r\n    constructor() {\r\n        super({ key: 'UiScene', active: true });\r\n    }\r\n\r\n    preload() {\r\n        this.gameState = GameState.singleton();\r\n        this.gameState.uiScene = this;\r\n\r\n        this.debugMessage = this.addText('');\r\n    }\r\n\r\n    create() {\r\n        this.previousHeight = this.cameras.main.height;\r\n        this.previousWidth = this.cameras.main.width;\r\n        this.startBeginningMessage();\r\n    }\r\n\r\n    resize() {\r\n        // extremely crude way to make sure all UI elements are in the same relative position on the screen after it has been resized.\r\n        // It will not preserve alignment. If a text element was originally centred it is unlikely to be exactly centred after resize.\r\n        const children = this.children.getAll();\r\n        children.forEach(child => {\r\n            const ui = child as any;\r\n\r\n            if (typeof ui.x == 'number' && typeof ui.y == 'number') {\r\n\r\n                const ratioX = ui.x / this.previousWidth;\r\n                const ratioY = ui.y / this.previousHeight;\r\n\r\n                ui.x = ratioX * this.cameras.main.width;\r\n                ui.y = ratioY * this.cameras.main.height;\r\n            }\r\n        });\r\n        this.previousWidth = this.cameras.main.width;\r\n        this.previousHeight = this.cameras.main.height;\r\n    }\r\n\r\n    update() {\r\n\r\n        let debugMsg = '';\r\n        if (this.gameState.debug.showMouseData) {\r\n            const pointer = this.gameState.fetchPointer();\r\n            const worldPointer = this.gameState.fetchWorldPointerPosition();\r\n            debugMsg += `Mouse: (${pointer.x.toFixed(2)}, ${pointer.y.toFixed(2)}) World: (${worldPointer.x.toFixed(2)}, ${worldPointer.y.toFixed(2)})    `;\r\n        }\r\n        if (this.gameState.debug.showResolutionData) {\r\n            const camera = this.gameState.scene.cameras.main;\r\n            debugMsg += `Camera (w,h): (${camera.width.toFixed(2)}, ${camera.height.toFixed(2)}) Camera Offset (x,y): (${camera.scrollX.toFixed(2)}, ${camera.scrollY.toFixed(2)})    `;\r\n        }\r\n        if (this.gameState.debug.showUiResolutionData) {\r\n            const camera = this.gameState.uiScene.cameras.main;\r\n            debugMsg += `UI Camera (w,h): (${camera.width.toFixed(2)}, ${camera.height.toFixed(2)}) UI Camera Offset (x,y): (${camera.scrollX.toFixed(2)}, ${camera.scrollY.toFixed(2)})    `;\r\n        }\r\n\r\n        if (debugMsg !== '') {\r\n            this.debugMessage.text = debugMsg;\r\n        }\r\n\r\n    }\r\n\r\n    startBeginningMessage() {\r\n        const helloMessage = this.addText('Hello. This is your pond.', 6);\r\n        helloMessage.x = this.findMiddleWidth(helloMessage);\r\n        helloMessage.y = (this.cameras.main.height / 4);\r\n        helloMessage.alpha = 0;\r\n        const foodMessage = this.addText('Try feeding a duck. Press on the water.', 4);\r\n        foodMessage.x = this.findMiddleWidth(foodMessage);\r\n        foodMessage.y = (this.cameras.main.height / 4);\r\n        foodMessage.alpha = 0;\r\n\r\n        const timeLine = this.tweens.timeline();\r\n        timeLine.add({\r\n            targets: helloMessage,\r\n            duration: 2000,\r\n            alpha: 1\r\n        })\r\n            .add({\r\n                targets: helloMessage,\r\n                duration: 4000\r\n            })\r\n            .add({\r\n                targets: helloMessage,\r\n                duration: 2000,\r\n                alpha: 0\r\n            })\r\n            // identical tween for a delay\r\n            .add({\r\n                targets: helloMessage,\r\n                duration: 2000,\r\n                alpha: 0\r\n            })\r\n            .add({\r\n                targets: foodMessage,\r\n                duration: 2000,\r\n                alpha: 1\r\n            })\r\n            .add({\r\n                targets: foodMessage,\r\n                duration: 4000\r\n            })\r\n            .add({\r\n                targets: foodMessage,\r\n                duration: 2000,\r\n                alpha: 0\r\n            });\r\n        timeLine.play();\r\n    }\r\n\r\n    addText(text: string, size: number = 2): Phaser.GameObjects.Text {\r\n        const textObject = this.add.text(0, 0, text, { fontFamily: FONT_FAMILY, fontSize: `${size}em` });\r\n        return textObject;\r\n    }\r\n\r\n    addTextWithDuration(text: string, seconds: number, size: number = 2): Phaser.GameObjects.Text {\r\n        const textObject = this.addText(text, size);\r\n        this.time.delayedCall(seconds * 1000, () => { textObject.destroy(); }, null, null);\r\n        return textObject;\r\n    }\r\n\r\n    displayDuckInfo(duck: Duck) {\r\n        this.duckInfoObjects.forEach(element => {\r\n            element.destroy();\r\n        });\r\n\r\n        const name = this.addText(duck.name, 4);\r\n        const title = this.add.text(0, 0, duck.duckling ? \"(a duck in training)\" : \"(the duck)\", { fontFamily: FONT_FAMILY, fontSize: '2em', fontStyle: 'italic' });\r\n        const thought = this.add.text(0, 0, `is thinking about ${duck.thought}`, { fontFamily: FONT_FAMILY, fontSize: '2em', fontStyle: 'italic' });\r\n        name.x = 40;\r\n        name.y = this.cameras.main.height * 0.75;\r\n\r\n        title.y = name.y + name.height - (title.height * 1.25);\r\n        title.x = name.x + name.width + 20;\r\n        thought.x = 80;\r\n        thought.y = name.y + 40;\r\n\r\n        this.duckInfoObjects = [name, title, thought];\r\n    }\r\n\r\n    displayToast(message: string) {\r\n        const delay = 15;\r\n        const toast = this.addText(message);\r\n        this.time.delayedCall(delay * 1000, () => {\r\n            this.toastMessages = this.toastMessages.filter(t => t !== toast);\r\n            toast.destroy();\r\n            this.repositionToasts();\r\n        }, null, null);\r\n        this.toastMessages.push(toast);\r\n        this.repositionToasts();\r\n\r\n    }\r\n\r\n    private repositionToasts() {\r\n        let y = this.toastY;\r\n        this.toastMessages.forEach(toastMessage => {\r\n\r\n            if (y > this.cameras.main.height * 0.75) { // don't display this many toasts\r\n                toastMessage.setVisible(false);\r\n            }\r\n            else {\r\n                toastMessage.setVisible(true);\r\n                toastMessage.y = y;\r\n                toastMessage.x = this.toastX;\r\n                y += this.toastYMargin + toastMessage.height;\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private findMiddleWidth(object: { width: number }): number {\r\n        return (this.cameras.main.width / 2) - (object.width / 2);\r\n    }\r\n\r\n}\r\n","import * as Phaser from 'phaser';\r\nimport { GameScene } from './gameScene';\r\nimport { UiScene } from './uiScene';\r\n\r\nexport const TARGET_WIDTH = 1536;\r\n\r\nconst gameConfig: Phaser.Types.Core.GameConfig = {\r\n    title: 'duck-game',\r\n\r\n    type: Phaser.AUTO,\r\n    scale: {\r\n        mode: Phaser.Scale.RESIZE,\r\n        width: '100%',\r\n        height: '100%'\r\n    },\r\n    parent: \"game-container\",\r\n    scene: [ GameScene, UiScene ],\r\n    backgroundColor: '#000000',\r\n};\r\n\r\nexport function setupGame(): Phaser.Game {\r\n    const game = new Phaser.Game(gameConfig);\r\n    return game;\r\n}\r\n","import React from 'react';\r\nimport './App.css';\r\nimport * as Game from './game/gameRunner'\r\n\r\nGame.setupGame();\r\n\r\nconst App: React.FC = () => {\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"centred-content\">\r\n        <div id=\"game-section\">\r\n          <div id=\"game-container\" />\r\n        </div>\r\n      </div>\r\n      <p>A pond with some hungry and slightly melancholy ducks. Built for <a className=\"App-link\" href=\"https://itch.io/jam/untitled-game-jam-37\" target=\"_blank\" rel=\"noopener noreferrer\">Untitled Game Jam</a>.</p>\r\n      Instructions for your pond:\r\n      <ul>\r\n        <li>Press on the water to feed the ducks</li>\r\n        <li>Press on the nest for a duck to lay eggs.</li>\r\n        <li>Press on a duck for duck facts.</li>\r\n      </ul>\r\n      <div id=\"footer\">\r\n        Duck Pond-ering 2020 - <a className=\"App-link\" href=\"https://github.com/RichTeaMan/duck-game\" target=\"_blank\" rel=\"noopener noreferrer\">Source Code</a>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}